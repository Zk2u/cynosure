# Miri configuration for LocalCell project

# Skip async tests since Miri doesn't support io_uring syscalls
[test]
skip = ["test_async_no_await_in_closure", "test_async_shared_state"]

# Miri flags for better debugging
[env]
MIRIFLAGS = "-Zmiri-backtrace=full -Zmiri-strict-provenance"

# Additional Miri settings
[flags]
# Enable strict provenance checking
strict-provenance = true

# Show full backtraces on errors
backtrace = "full"

# Enable additional checks
check-number-validity = true

# Detect memory leaks
detect-leaks = true

# Enable tag tracking for better stacked borrows debugging
tag-tracking = true
